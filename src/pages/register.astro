---
import Layout from '../layouts/Layout.astro';
import { supabase } from '../lib/supabase';
import { map } from 'nanostores';
import type { APIRoute } from "astro";
// import { APIRoute } from 'astro';



/// Leer en consola todos los datos
// let { data: user, error } = await supabase
//   .from('user')
//   .select('*')
// console.log(user, error);

/// Insertar datos
const { data, error } = await supabase
    .from('user')
    .insert([
        { nombre: String },
        { email: String },
        { password: String },
        { fecNacimiento: Date },
        { direccion: String },
        { ciudad: String }
    ])
  .select()
const { data: insertData, error: insertError, } = await supabase
  .from('user')
  .insert([
    { nombre: String, email: String, password: String, fecNacimiento: new Date(), direccion: String, ciudad: String }
  ])
  .select();



---

    <Layout title='Registrar'>
        <main>
            <h1>Registrar</h1>
            <form action="/api/auth/register" method="post">
                <label for="nombre" >Nombre</label>
                <input class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400
                focus:outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500
                disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none
                invalid:border-pink-500 invalid:text-pink-600
                focus:invalid:border-pink-500 focus:invalid:ring-pink-500
              " type="text" name="name" id="nombre" required>
                <label for="email">Correo Eléctronico</label>
                <input class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400
                focus:outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500
                disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none
                invalid:border-pink-500 invalid:text-pink-600
                focus:invalid:border-pink-500 focus:invalid:ring-pink-500
              " type="email" name="email" id="email" required>
                <label for="password">Contraseña</label>
                <input class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400
                focus:outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500
                disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none
                invalid:border-pink-500 invalid:text-pink-600
                focus:invalid:border-pink-500 focus:invalid:ring-pink-500
              " type="password" name="password" id="password" required>
                <label for="fecNacimiento">Fecha de Nacimiento</label>
                <input class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400
                focus:outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500
                disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none
                invalid:border-pink-500 invalid:text-pink-600
                focus:invalid:border-pink-500 focus:invalid:ring-pink-500
              " type="date" name="fecNacimiento" id="fecNacimiento" required>
                <label for="ciudad">Ciudad</label>
                <input class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400
                focus:outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500
                disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none
                invalid:border-pink-500 invalid:text-pink-600
                focus:invalid:border-pink-500 focus:invalid:ring-pink-500
              " type="text" name="ciudad" id="ciudad" required>
                <label for="direccion">Dirección (hogar)</label>
                <input class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400
                focus:outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500
                disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none
                invalid:border-pink-500 invalid:text-pink-600
                focus:invalid:border-pink-500 focus:invalid:ring-pink-500
              " type="text" name="direccion" id="direccion" required>
                <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full" type="submit" id="button">Registrar</button>
            </form>
            
        
        </main>

        <!-- <script>
          function registroClick(){
            console.log('boton pulsado');
          }
          document.getElementById('button').addEventListener('click', registroClick);
        </script> -->

    </Layout> 



<style>

</style>

